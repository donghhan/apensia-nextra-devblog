---
title: 파이썬을 활용한 선형대수 기초 
image: https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/Linear_subspaces_with_shading.svg/250px-Linear_subspaces_with_shading.svg.png
description: 파이썬을 활용한 선형대수 기초
date: November 28th, 2022
---

import Bleed from 'nextra-theme-docs/bleed'

# 선형대수의 기초

## 벡터

크기와 방향을 모두 가지고 있는 물리량을 의미한다 (예: 속도, 힘).

- 벡터는 좌표평면 공간에서 *한 점*을 나타내며, 이는 원점으로부터 상대적인 *위치*를 표현한다.
- 벡터에 숫자를 곱해주면 <ins>길이</ins>만 변하게 된다.
- 벡터는 숫자를 원소로 가지는 배열이며, 같은 모양을 가지게 되면 덧셈과 뺄셈, 성분곱(Hadamard product)을 계산할 수 있다.

## 행렬

수나 수를 나타내는 문자를 괄호 안에 직사각형 꼴로 배열한 것

### 단위행렬

임의의 $n$차 정사각행렬 $A$에 대하여 $AE=EA=A$를 만족시키는 정사각행렬 $E$를 <ins>**단위행렬**</ins>이라 한다.
즉, 어떠한 행렬이든 단위행렬을 곱해도 같은 결괏값을 가져온다. 보통 표시는 $l_n \in\R^{n \times n}$ 꼴로 표현한다.

<center>
2차 단위행렬의 예:
$\begin{pmatrix}
1 & 0 \\
0 & 1
\end{pmatrix}$
&nbsp;
&nbsp;
3차 단위행렬의 예:
$\begin{pmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1
\end{pmatrix}$

단위행렬의 연산 예:
$\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
x_1 \\
x_2 \\
x_3
\end{bmatrix}
=$
$\begin{bmatrix}
x_1 \\
x_2 \\
x_3
\end{bmatrix}
$

</center>

### 역행렬

정사각행렬 $A$에 대하여 $AX=XA=E$를 만족시키는 행렬 $X$가 존재할 때, $X$를 $A$의 <ins>**역행렬**</ins>이라 하고, $A^{-1}$로 표현한다.

2차 정사각행렬 $A = $
$\begin{bmatrix}
a & b \\
c & d
\end{bmatrix}$
가 주어졌을 때, 역행렬 $A^{-1}$는

<center>
$A^{-1} =$
$\dfrac{1}{ad - bc}$
$\begin{bmatrix}
d & -b \\
-c & a
\end{bmatrix}$
</center>

### 행렬의 연산

#### 교환 법칙

덧셈의 경우 교환 법칙은 성립한다.

<center>
$A + B = B + A$
</center>

단, 곱셈의 경우 교환 법칙이 항상 성립하진 않는다. 즉, $AB \ne BA$이다.

1. 예1: $A \in\R^{2 \times 3}$, $B \in\R^{3 \times 5}$일 때, $AB \in\R^{2 \times 5}$로 성립하나, $BA$는 성립하지 않는다.
2. 예2: $A \in\R^{3 \times 2}$, $B \in\R^{2 \times 3}$일 때, $AB$ 및 $BA$ 모두 성립하나, $AB \in\R^{3 \times 3}$, $BA \in\R^{2 \times 2}$
3. 예3: $A \in\R^{2 \times 2}$, $B \in\R^{2 \times 2}$일 때, $AB$ 및 $BA$의 차원은 같으나, $AB \ne BA$이다.

   - 반례: $A = \begin{bmatrix}
    1 & 2 \\
    3 & 4
    \end{bmatrix}$,
     &nbsp;
     $B = \begin{bmatrix}
    5 & 6 \\
    7 & 8
    \end{bmatrix}$일 때,
     $AB = \begin{bmatrix}
    19 & 22 \\
    43 & 50
    \end{bmatrix}$이나,
     $BA = \begin{bmatrix}
    23 & 34 \\
    31 & 46
    \end{bmatrix}$

#### 분배 법칙

<center>
$A\lparen B+C\rparen = AB + AC$

$c\lparen A+B\rparen = cA + cB$ (단, $c$는 상수)

</center>

#### 결합 법칙

<center>
$A\lparen BC\rparen = \lparen AB\rparen C$
</center>

#### 전치 행렬

<center>
$\lparen AB\rparen^T = B^TA^T$
</center>

<br/>

<center>![matrix_transpose](https://mblogthumb-phinf.pstatic.net/20151214_116/jo_hyun_14500773481167Uo2H_GIF/Matrix_transpose.gif?type=w2)</center>

## 일차방정식

변수 $x_1, x_2, ..., x_n$와 상수 $b$에 대하여 다음과 같이 최고 차수의 항의 차수가 1을 넘지 않는 다항 방정식을 의미한다.

<br/>

<center>$a_1x_1 + a_2x_2 + ... +a_nx_n$</center>

이 때, $a_1, a_2, ..., a_n$은 <ins>**계수(가중치)**</ins>라고 불리운다. 이를 행렬로 나타내보면

<br/>

<center>
$a = 
\begin{bmatrix}
  a_1 \\
  a_2 \\
  ... \\
  a_n
\end{bmatrix}
$
, 
$x = 
\begin{bmatrix}
  x_1 \\
  x_2 \\
  ... \\
  x_n
\end{bmatrix}
$
일 때,
$a^{T}x = b$
</center>

로 나타낼 수 있다.

### 선형 시스템

일차 방정식들의 집합을 뜻한다. 동일한 $n$개의 변수를 가진 $m$개의 일차방정식들은 다음과 같이 표시될 수 있다.

<br/>

<center>
$
a_{11}x_1 + a_{12}x_2 + ... + a_{1n}x_n = b_1
$

$
a_{21}x_1 + a_{22}x_2 + ... + a_{2n}x_n = b_2
$

$
...
$

$
a_{m1}x_1 + a_{m2}x_2 + ... + a_{mn}x_n = b_m
$

</center>

### 선형시스템의 해 구하기

선형시스템(연립방정식)의 해에는 다음과 같은 케이스들이 존재할 수 있다.

1. (각 미지수 별로) 해가 존재할 경우
2. 해가 없을 경우
3. 해가 무수히 많을 경우

<br/>

#### 역행렬을 이용하여 해 구하기

만일 행렬 $A$에 대한 역행렬이 존재한다고 가정했을 때,

<br/>

<center>
$AX = B \Leftrightarrow X = A^{-1}B $
</center>

가 성립하게 된다. 이 말인 즉슨, <ins>**가중치 행렬의 역행렬이 존재하지 않으면 해가 존재하지 않음**</ins>을 알 수 있다.

<br/>

#### 해가 존재할 경우

다음을 예시를 들어보자.

<center>
$
x_1 + x_2 - x_3 = 0
$

$
2x_1 - x_2 + 3x_3 = 9
$

$
x_1 + 2x_2 + x_3 = 8
$

</center>

위의 식들을 행렬로 표현해본다면

<br/>

<center>

$\begin{bmatrix}
1 & 1 & -1 \\
2 & -1 & 3 \\
1 & 2 & 1 \\
\end{bmatrix}$
$
\begin{bmatrix}
x_1 \\
x_2 \\
x_3 \\
\end{bmatrix}
$
$=$
$
\begin{bmatrix}
0 \\
9 \\
8 \\
\end{bmatrix}
$

</center>

와 같이 표현할 수 있다. 이 때

<center>
$A = 
\begin{bmatrix}
1 & 1 & -1 \\
2 & -1 & 3 \\
1 & 2 & 1 \\
\end{bmatrix}
$
&nbsp;
$B = 
\begin{bmatrix}
0 \\
9 \\
8 \\
\end{bmatrix}
$
</center>

라 한다면, $A$의 역행렬을 구해보면 답을 알 수 있다.

```py
import sympy as sy
from sympy.solvers.solveset import linsolve

x1, x2, x3 = sy.symbols("x1 x2 x3")
A = sy.Matrix(((1, 1, -1), (2, -1, 3), (1, 2, 1)))
B = sy.Matrix((0, 9, 8))

system = A, B
linsolve(system, x1, x2, x3) # {(1, 2, 3)}
```

<br/>

#### 해가 없는 경우

다음을 예시를 들어보자.

<center>
$
x_1 + x_2 + x_3 = 1
$

$
x_1 - x_2 - 2x_3 = 2
$

$
2x_1 - x_3 = 1
$

</center>

위의 식들을 행렬로 표현해본다면

<br/>

<center>

$\begin{bmatrix}
1 & 1 & 1 \\
1 & -1 & -2 \\
2 & 0 & -1 \\
\end{bmatrix}$
$
\begin{bmatrix}
x_1 \\
x_2 \\
x_3 \\
\end{bmatrix}
$
$=$
$
\begin{bmatrix}
1 \\
2 \\
1 \\
\end{bmatrix}
$

</center>

와 같이 표현할 수 있다. 하지만 $A$의 역행렬을 구해보려 하면 값이 없음을 알 수 있고, 역행렬이 존재하는지 여부를 판별해주는 <a href="https://docs.sympy.org/latest/modules/matrices/matrices.html?highlight=det#sympy.matrices.matrices.MatrixDeterminant.det" target="_blank">`.det()`</a>를 구해보면 알 수 있다.

```py
import sympy as sy
from sympy.solvers.solveset import linsolve

x1, x2, x3 = sy.symbols("x1 x2 x3")
A = sy.Matrix(((1, 1, 1), (1, -1, -2), (2, 0, -2)))
B = sy.Matrix((1, 2, 1))

system = A, B
linsolve(system, x1, x2, x3) # null
A.det() # 0
```

<br/>

위 코드에서 `A.det()`의 값이 `0`인 것을 알 수 있으므로 이는 역행렬이 존재하지 않으며, <ins>**따라서 해가 존재하지 않는다**</ins>.

<br/>

#### 해가 무수히 많을 경우

```py
import sympy as sy
from sympy.solvers.solveset import linsolve

x1, x2, x3 = sy.symbols("x1 x2 x3")
A = sy.Matrix(((1, 1, 1), (1, -1, -2), (2, 0, -2)))
B = sy.Matrix((1, 2, 1))

system = A, B
linsolve(system, x1, x2, x3) # {(-3*x3/2, x3 + 4, x3)}
A.det() # 0
```

위 코드에서 `linsolve(system, x1, x2, x3)`의 값이 나온 것으로 보아 어떤 $x_3$의 값에 대해서도 위와 같은 형태의 벡터는 해가 될 수 있음을 알 수 있다.
또한, `A.det()`의 값이 0이다. 따라서, <ins>**해가 무수히 많다**</ins>.

<br/>

## 선형 결합

<a href="https://en.wikipedia.org/wiki/Linear_combination" target="_blank">선형 결합</a>이란, 각 항에 상수를 곱하고 결과를 추가함으로써 일련의 항으로 구성된 표현식이다.
각각의 벡터 $v_1, v_2, ..., v_p$와 스칼라 $c_1, c_2, ..., c_p$가 존재할 경우 해당 스칼라의 계수의 선형 결합은

<br/>

<center>
<font size="5">
$
c_{1}v_1 + ... + c_{p}v_{p}
$
</font>
</center>

와 같이 표현될 수 있다. 이 때, 가중치는 0을 포함한 어떠한 실수도 된다.

### 생성

각각의 벡터 $v_1, v_2, ..., v_p \in\R^{n}$가 존재할 때 $v_1, v_2, ..., v_p$의 Span은 <ins>**모든 선형 결합들의 집합**</ins>이다.
즉, 벡터 공간 상에 존재하는 이 벡터들로 이루어진 조합의 모든 경우의 수를 지칭한다.

<br/>

<center>
<font size="5">
$
span [a_1, a_2, ..., a_k] = \displaystyle\sum_{i=1}^n \alpha_{i}a_{i} 
$
</font>
</center>

## 선형 독립

집합 $S = { v_1, v_2, ..., v_n}$의 벡터들은 $c_{1}v_1 + ... + c_{n}v_{n} = \overrightarrow{O}$를 만족하는 계수들이 $c_1 = 0, c_2 = 0, ..., c_n = 0$ 이외에는
존재하지 않을 때, 이를 <ins>**선형적으로 독립**</ins>이라고 한다.

### 기저

<ins>좌표의 축 역할을 해주는 벡터의 집합</ins>을 의미한다.

예를 들어, 2차원 평면 상에서 좌표 $(x, y)$가 존재할 때 $(x, y) = xe_1 + ye_2$로 표현할 수 있다.
여기서 $e_1 = (1, 0)$, $e_2 = (0, 1)$를 의미하고 $B = {e_1, e_2}$라 할 때, $B$를 **기저**라 부른다.
