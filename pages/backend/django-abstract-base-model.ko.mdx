---
title: Django에서 한 모델을 DB에 따로 저장하지 않고 다른 모델에서 사용하기
image: https://course.oc-static.com/courses/7107341/7107341_teaser_picture_1633008310.jpg
description: "추상화 베이스 모델에 대하여"
date: November 3rd, 2022
---

import Callout from 'nextra-theme-docs/callout'
import Bleed from 'nextra-theme-docs/bleed'

# Django에서 한 모델을 DB에 따로 저장하지 않고 다른 모델에서 사용하기

필자가 letsh 어플리케이션을 제작하면서 느꼈던 점이 어떠한 종류의 데이터든지 간에
공통적으로 <ins>공유</ins>될 수 있는 데이터가 있지 않을까라는 생각을 했다.
가장 대표적인 것이 데이터가 새로이 생성되거나 업데이트된 시간이라 할 수 있겠다.
이러한 데이터들을 추가해놓으면 추후에 어드민 유저들이 시간대별로 정확하게 데이터를 관리할 수 있겠다라는 생각을 하였다.

<br/>

## 추상화 베이스 모델

하지만 이러한 데이터 필드들을 일일히 모든 앱의 모델 클래스에 정의하는 것은 불필요한 코드의 반복일 뿐더러 추후에 DB 쓸데없이 너무 많은 데이터가 쌓일 수도 있다.
따라서 이러한 데이터를 다루는 모델은 <ins>**_쓸데없이 DB의 공간을 차지하지 않으면서 다른 모델에서도 동시에 사용될 수 있도록 하는 것_**</ins>이 제일 효율적이었다.

여기서 <a href="https://docs.djangoproject.com/en/4.1/topics/db/models/#abstract-base-classes" target="_blank">추상화 베이스 모델</a>이 사용되게 된다.
즉, 공통적으로 사용될 정보들에 대한 데이터 필드를 정의한 후, <a href="https://docs.python.org/3/tutorial/classes.html#inheritance" target="_blank">클래스의 상속</a>을 통해
다른 앱의 모델에서도 공통 모델에 사용된 데이터들을 언제든지 사용할 수 있는 것이다.

<br/>

## 구현

### 앱 생성

필자는 `common`이라는 새로운 앱을 만들었다. 이 앱 안에 위에서 언급한 데이터들을 다루는 모델을 만들어 볼 것이다.

```bash
django-admin startapp common
```

<br/>

이후, `settings.py`에 우리가 만든 `common` 앱을 등록하도록 하자.
필자는 추후에 앱이 좀 복잡해질 것을 우려하여 기존에 있던 <a href="https://docs.djangoproject.com/en/4.1/ref/settings/#installed-apps" target="_blank"><code>INSTALLED_APPS</code></a>를 나누기로 하였다.

1. `DJANGO_APPS`: 이미 기존에 설치되었던 Django 관련 앱들
2. `THIRDPARTY_APPS`: 추후에 외부 라이브러리 패키지들을 설치하기 위한 용도
3. `MANUALLY_INSTALLED_APPS`: 필자가 직접 설치한 앱들

<br/>

그리고 상기 3개를 모두 `INSTALLED_APPS`로 묶어주었다.

```py config/settings.py
DJANGO_APPS = [
    "django.contrib.admin",
    "django.contrib.auth",
    "django.contrib.contenttypes",
    "django.contrib.sessions",
    "django.contrib.messages",
    "django.contrib.staticfiles",
]

THIRDPARTY_APPS = []

MANUALLY_INSTALLED_APPS = [
    "common.apps.CommonConfig",
]

INSTALLED_APPS = DJANGO_APPS + THIRDPARTY_APPS + MANUALLY_INSTALLED_APPS
```

<br/>

### 모델 만들기

`common/` 앱 폴더 내부의 `models.py` 파일을 수정해보자.

<CH.Scrollycoding>

#### 모델 클래스 생성

데이터의 생성 및 업데이트를 관리해주는 `TimeStampModel`이라는 모델 클래스를 만들어주었다.

```py focus=3:7
from django.db import models

class TimeStampModel(models.Model):

    """TimeStamp Model Definition"""

    pass
```

---

#### `Meta` 클래스 설정

<a href="https://docs.djangoproject.com/en/4.1/topics/db/models/#meta-options" target="_blank"><code>Meta</code> 클래스</a>는 해당 모델 클래스에 추가적인 설정을 해줄 수 있다.
공통 모델은 추상화 베이스 모델이기 때문에 <a href="https://docs.djangoproject.com/en/4.1/topics/db/models/#abstract-base-classes" target="_blank">공식 문서</a>에서 설명한 것처럼 
`abstract = True`를 설정해 주었다.

이렇게 될 경우 DB 테이블을 생성하지 않는 대신 다른 앱의 모델에서 사용되었을 때 해당 필드들을 사용할 수 있다.

```py focus=9:10
from django.db import models

class TimeStampModel(models.Model):

    """TimeStamp Model Definition"""

    pass

    class Meta:
        abstract = True
```

---

#### `DateTimeField`

마지막으로 필드들을 설정해 주었다.

<a href="https://docs.djangoproject.com/en/4.1/ref/models/fields/#django.db.models.DateTimeField" target="_blank"><code>DateTimeField</code></a>은 글자에서 그대로 알 수 있듯이 
날짜와 시간을 관장하는 모델 필드이다. 그 중에서 생성된 날짜/시간을 `created_at`로, 업데이트된 날짜/시간을 `updated_at`라는 이름으로 필드를 설정해주었다.

여기서 <a href="https://docs.djangoproject.com/en/4.1/ref/models/fields/#django.db.models.DateField.auto_now_add" target="_blank"><code>auto_now_add</code></a> 속성은
어떤 객체가 처음으로 <ins>생성될 떄</ins> 자동적으로 현재 시점으로 설정을 해준다.

반면 <a href="https://docs.djangoproject.com/en/4.1/ref/models/fields/#django.db.models.DateField.auto_now" target="_blank"><code>auto_now</code></a>의 경우
어떤 객체가 처음으로 <ins>업데이트될 때</ins>자동적으로 현재 시점으로 설정을 해준다.

```py focus=7:8
from django.db import models

class TimeStampModel(models.Model):

    """TimeStamp Model Definition"""

    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    class Meta:
        abstract = True
```

</CH.Scrollycoding>

<br/>

## 참고 자료

- <a href="https://dev.to/sankalpjonna/using-abstract-models-in-django-1igi" target="_blank">Using abstract models in Django</a>
