---
title: "AttributeError: can't set attribute 'is_staff'"
image: https://www.tabnine.com/academy/wp-content/uploads/2020/10/academy_1.png
description: '커스텀 User 모델에서 어드민 계정을 만드는 도중 발생된 에러'
---

import Callout from 'nextra-theme-docs/callout'
import Bleed from 'nextra-theme-docs/bleed'
import { SiJavascript, SiPython } from 'react-icons/si'

# `AttributeError: can't set attribute 'is_staff'`

## 시도

`AbstractBaseUser`를 통해 커스터마이징된 `User` 모델을 만든 후 `python manage.py createsuperuser` 명령어를 통해 슈퍼 유저 계정을 생성하고자 했다.

<br/>

## 문제 발생

콘솔에 갑자기 `AttributeError` 에러 메세지가 다음과 같이 나타났다.

```
Traceback (most recent call last):
  File "/Users/apensia/dev/letsh-api/manage.py", line 24, in <module>
    main()
  File "/Users/apensia/dev/letsh-api/manage.py", line 20, in main
    execute_from_command_line(sys.argv)
  File "/Users/apensia/dev/letsh-api/.venv/lib/python3.10/site-packages/django/core/management/__init__.py", line 446, in execute_from_command_line
    utility.execute()
  File "/Users/apensia/dev/letsh-api/.venv/lib/python3.10/site-packages/django/core/management/__init__.py", line 440, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/Users/apensia/dev/letsh-api/.venv/lib/python3.10/site-packages/django/core/management/base.py", line 414, in run_from_argv
    self.execute(*args, **cmd_options)
  File "/Users/apensia/dev/letsh-api/.venv/lib/python3.10/site-packages/django/contrib/auth/management/commands/createsuperuser.py", line 87, in execute
    return super().execute(*args, **options)
  File "/Users/apensia/dev/letsh-api/.venv/lib/python3.10/site-packages/django/core/management/base.py", line 460, in execute
    output = self.handle(*args, **options)
  File "/Users/apensia/dev/letsh-api/.venv/lib/python3.10/site-packages/django/contrib/auth/management/commands/createsuperuser.py", line 232, in handle
    self.UserModel._default_manager.db_manager(database).create_superuser(
  File "/Users/apensia/dev/letsh-api/users/models.py", line 22, in create_superuser
    user.is_staff = True
AttributeError: can't set attribute 'is_staff'
```

<br/>

## 문제 분석

에러 메세지 글자 그대로에서 볼 수 있듯이 `is_staff`라는 속성을 찾을 수가 없었다.

<a href="https://stackoverflow.com/a/64102244/13121145" target="_blank">Stack Overflow</a>에서 찾은 답변을 보면 `@property`라는 데코레이터에 setter 메소드가 존재하지 않을 경우 
이러한 에러가 발생될 수 있다는 점을 지목했다.

## 문제 해결

### `User` 모델

`is_staff`는 `@property` 데코레이터로 지정되어 있는 속성이다. 이 부분은 필자가 만든 커스터마이징된 `User` 모델에 이미 있는 부분이었다.

```py
class User(AbstractBaseUser):

    """Custom User Definition Model"""

    # 중략

    @property
    def is_staff(self):
        return self.is_admin
```

<br/>

<CH.Scrollycoding>

### `Manager` 부분

`MyUserManager` 부분에 문제의 코드를 살펴보았다. `is_admin` 이외에 불필요한 `is_superuser`와 `is_staff` 부분이 들어있는 것을 확인하였다.

```py focus=15:16
class MyUserManager(BaseUserManager):
    def create_user(self, email, password=None, **extra_fields):
        if not email:
            raise ValueError(_("You must provide a valid email address."))

        user = self.model(email=self.normalize_email(email), **extra_fields)

        user.set_password(password)
        user.save(using=self._db)
        return user

    def create_superuser(self, email, password=None):
        user = self.create_user(email, password=password)
        user.is_admin = True
        user.is_superuser = True
        user.is_staff = True
        user.save(using=self._db)
        return user
```

---

### `is_staff` 항목 삭제

`is_admin`을 제외한 나머지 불필요하게 들어가게 되는 속성들인 `is_superuser`와 `is_staff` 부분을 삭제해주었다.

```py
class MyUserManager(BaseUserManager):
    def create_user(self, email, password=None, **extra_fields):
        if not email:
            raise ValueError(_("You must provide a valid email address."))

        user = self.model(email=self.normalize_email(email), **extra_fields)

        user.set_password(password)
        user.save(using=self._db)
        return user

    def create_superuser(self, email, password=None):
        user = self.create_user(email, password=password)
        user.is_admin = True
        user.save(using=self._db)
        return user
```

</CH.Scrollycoding>
