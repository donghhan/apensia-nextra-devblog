---
title: Customzing Django password validator
image: https://course.oc-static.com/courses/7107341/7107341_teaser_picture_1633008310.jpg
description: 'Customizing password validator with using Django password-validation feature.'
date: 'November 3rd, 2022'
---

import Callout from 'nextra-theme-docs/callout'
import Bleed from 'nextra-theme-docs/bleed'

# Customzing Django password validator

Django provides the awesome built-in <a href="https://docs.djangoproject.com/en/4.0/topics/auth/passwords/#module-django.contrib.auth.password_validation" target="_blank">password validator</a>
that can be applied throughout the whole page by the time you initiate Django project.

Not too bad. However, I felt somehow some of them are "too much" or unnecessary. Therefore, I felt it would be much better if I can create my own custom password validator
that contains my whole password requirements that I want.

In this section, we are going to go over how can we create our own custom password validator.

<br/>

## Taking a look at `settings.py`

If you go to `settings.py` file, you will be able to see the Django's built-in password validators in `AUTH_PASSWORD_VALIDATORS`.
For more options, please refer to <a href="https://docs.djangoproject.com/en/4.1/topics/auth/passwords/#enabling-password-validation" target="_blank">here</a>.

```python settings.py
AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]
```

<br/>

## Creating custom password validator

I created password validator file with naming `validators.py` inside of `users` app folder.

```
# For Mac/Linux
touch users/validators.py

# For Windows Command Prompt
echo.>validators.py

# For Windows Powershell
ni users/validators.py
```

<br/>

<CH.Scrollycoding>

### Creating custom validator class

I created the custom password validator class called `CustomPasswordValidator`.

As mentioned in <a href="https://docs.djangoproject.com/en/4.1/topics/auth/passwords/#writing-your-own-validator" target="_blank">documentation</a>, we are required to define the two methods.

1. `validate()`: This is where all our custom password validation logics will go.
2. `get_help_text()`: This is the help text that will be shown on the admin page.

```python users/validators.py focus=1,3:4,17
from django.core.exceptions import ValidationError

class CustomPasswordValidator():
    def validate(self, password, user=None):
        MIN_LENGTH = 1
        special_characters = "[~\!@#\$%\^&\*\(\)_\+{}\":;'\[\]]"

        if not any(c.isdigit() for c in password):
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} digit.")
        if not any(c.isalpha() for c in password):
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} character.")
        if not any(c.isupper() for c in password): # 3
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} uppercase.")
        if not any(c in special_characters for c in password): # 4
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} special characters.")

    def get_help_text():
        pass
```

---

### Inserting help text

I would like my custom passwords follow the below criteria:

- It must include at least one number.
- It must include at least one lowercase.
- It must include at least one uppercase.
- It must include at least one special character.

Therefore, inside the `get_help_text()` method, I included the text that explains how should my password validator look like.
This could be used as an error message if users attempted to create the password that does NOT match up with the criteria.

```python users/validators.py focus=18
from django.core.exceptions import ValidationError

class CustomPasswordValidator():
    def validate(self, password, user=None):
        MIN_LENGTH = 1
        special_characters = "[~\!@#\$%\^&\*\(\)_\+{}\":;'\[\]]"

        if not any(c.isdigit() for c in password):
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} digit.")
        if not any(c.isalpha() for c in password):
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} character.")
        if not any(c.isupper() for c in password): # 3
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} uppercase.")
        if not any(c in special_characters for c in password): # 4
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} special characters.")

    def get_help_text():
        return "Password should be no less than 8 characters with including at least 1 uppercase, lowercase, number and special character."
```

---

#### Declaring variables

Now, it's time to create our logic for `CustomPasswordValidator`. As I want to include at least one uppercase, lowercase, number and special character, I set variable `MIN_LENGTH` as `1` for this.

Also, I included the list of special characters as a string value that will be used as RegEx.

```python users/validators.py focus=5:6
from django.core.exceptions import ValidationError

class CustomPasswordValidator():
    def validate(self, password, user=None):
        MIN_LENGTH = 1
        special_characters = "[~\!@#\$%\^&\*\(\)_\+{}\":;'\[\]]"

        if not any(c.isdigit() for c in password):
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} digit.")
        if not any(c.isalpha() for c in password):
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} character.")
        if not any(c.isupper() for c in password): # 3
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} uppercase.")
        if not any(c in special_characters for c in password): # 4
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} special characters.")

    def get_help_text():
        return "Password should be no less than 8 characters with including at least 1 uppercase, lowercase, number and special character."
```

---

### Including at least one number

With using <a href="https://docs.python.org/3/library/stdtypes.html?highlight=isdigit#bytearray.isdigit"><code>isdigit()</code></a> method, we will check any characters that are numbers.
If all values in the sequence are numbers, then it will return `True`.

In this case, `c.isdigit() for c in password` will check that for every single one word in `password` that users provided, it will check whether they are all numbers.

Then, we will wrap the above interation with <a href="https://docs.python.org/3/library/functions.html#any" target="_blank"><code>any()</code></a> method, so that we can get `True` value
if there is **_at least one_** number in the password.

Finally, with using `not` keyword, the whole logic for the first `if` logic would be

> If there is NO number in the users' password at all ...

If this true, then we will raise the <a href="https://docs.djangoproject.com/en/4.0/ref/exceptions/#django.core.exceptions.ValidationError" target="_blank"><code>ValidationError</code></a> with the custom error message that we defined above.

```py users/validators.py focus=8:9
from django.core.exceptions import ValidationError

class CustomPasswordValidator():
    def validate(self, password, user=None):
        MIN_LENGTH = 1
        special_characters = "[~\!@#\$%\^&\*\(\)_\+{}\":;'\[\]]"

        if not any(c.isdigit() for c in password):
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} digit.")
        if not any(c.isalpha() for c in password):
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} character.")
        if not any(c.isupper() for c in password): # 3
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} uppercase.")
        if not any(c in special_characters for c in password): # 4
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} special characters.")

    def get_help_text():
        return "Password should be no less than 8 characters with including at least 1 uppercase, lowercase, number and special character."
```

---

### Including at least one alphabetic cases

Same logic is applied as we did on the previous section.
This time, we will be using <a href="https://docs.python.org/3/library/stdtypes.html?highlight=isalpha#bytearray.isalpha"><code>isalpha()</code></a> method, we will check all characters whether they are alphabets.
If it is, then it will return `True`.

Our final logic for this would be

> If there is NO alphabets in the users' password at all ...

If this true, then we will raise the <a href="https://docs.djangoproject.com/en/4.0/ref/exceptions/#django.core.exceptions.ValidationError" target="_blank"><code>ValidationError</code></a>.

```py users/validators.py focus=10:11
from django.core.exceptions import ValidationError

class CustomPasswordValidator():
    def validate(self, password, user=None):
        MIN_LENGTH = 1
        special_characters = "[~\!@#\$%\^&\*\(\)_\+{}\":;'\[\]]"

        if not any(c.isdigit() for c in password):
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} digit.")
        if not any(c.isalpha() for c in password):
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} character.")
        if not any(c.isupper() for c in password): # 3
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} uppercase.")
        if not any(c in special_characters for c in password): # 4
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} special characters.")

    def get_help_text():
        return "Password should be no less than 8 characters with including at least 1 uppercase, lowercase, number and special character."
```

---

### Including at least one uppercase

We will be using <a href="https://docs.python.org/3/library/stdtypes.html?highlight=isalpha#bytearray.isalpha"><code>isupper()</code></a> method, we will check all characters whether they are uppercases.
If it is, then it will return `True`.

Our final logic for this would be

> If there is NO uppercases in the users' password at all ...

If this true, then we will raise the <a href="https://docs.djangoproject.com/en/4.0/ref/exceptions/#django.core.exceptions.ValidationError" target="_blank"><code>ValidationError</code></a>.

```py users/validators.py focus=12:13
from django.core.exceptions import ValidationError

class CustomPasswordValidator():
    def validate(self, password, user=None):
        MIN_LENGTH = 1
        special_characters = "[~\!@#\$%\^&\*\(\)_\+{}\":;'\[\]]"

        if not any(c.isdigit() for c in password):
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} digit.")
        if not any(c.isalpha() for c in password):
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} character.")
        if not any(c.isupper() for c in password): # 3
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} uppercase.")
        if not any(c in special_characters for c in password): # 4
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} special characters.")

    def get_help_text():
        return "Password should be no less than 8 characters with including at least 1 uppercase, lowercase, number and special character."
```

---

### Including at least one special characters

Finally, we are going to check if user's password contains any special characters.

```py users/validators.py focus=14:15
from django.core.exceptions import ValidationError

class CustomPasswordValidator():
    def validate(self, password, user=None):
        MIN_LENGTH = 1
        special_characters = "[~\!@#\$%\^&\*\(\)_\+{}\":;'\[\]]"

        if not any(c.isdigit() for c in password):
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} digit.")
        if not any(c.isalpha() for c in password):
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} character.")
        if not any(c.isupper() for c in password): # 3
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} uppercase.")
        if not any(c in special_characters for c in password): # 4
            raise ValidationError(f"Password must contain at least {MIN_LENGTH} special characters.")

    def get_help_text():
        return "Password should be no less than 8 characters with including at least 1 uppercase, lowercase, number and special character."
```

</CH.Scrollycoding>

<br/>

## Including our custom password validator

<CH.Scrollycoding>

Now that we created our own custom password validator, we are going to include it in <a href="https://docs.djangoproject.com/en/4.0/ref/settings/#std-setting-AUTH_PASSWORD_VALIDATORS" target="_blank"><code>AUTH_PASSWORD_VALIDATORS</code></a>.

```python settings.py
AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]
```

---

You are more than welcomed to delete the unnecessary password validator if you want.
In this case, I deleted <a href="https://docs.djangoproject.com/en/4.0/topics/auth/passwords/#django.contrib.auth.password_validation.UserAttributeSimilarityValidator" target="_blank"><code>UserAttributeSimilarityValidator</code></a>
as I think this validator is too strict for users that it won't allow users to create password if password is too similar with attribute of users.

```python settings.py
AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]
```

---

Instead, we are going to include our `CustomPasswordValidator` class that we made in our `validators.py` file.

```python settings.py focus=2:4
AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'users.validators.CustomPasswordValidator'
    }
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]
```

</CH.Scrollycoding>

<br/>

## Result

If you are typing only numbers, you will get error as below:

<center>![error_when_typed_only_numbers](../../media/custom-password-validator/error1.png)</center>

And when you only type strings:

<center>![error_when_typed_only_numbers](../../media/custom-password-validator/error2.png)</center>

And when you only type lowercase and numbers:

<center>![error_when_typed_only_numbers](../../media/custom-password-validator/error3.png)</center>

And finally when you omitted the special characters:

<center>![error_when_typed_only_numbers](../../media/custom-password-validator/error4.png)</center>

<br/>

## Reference

1. <a href="https://www.youtube.com/watch?v=SRYBDmJlIck" target="_blank">How to do password validation with the Django web framework</a>
